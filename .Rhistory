#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
period <<- c(seq(from = step, to = T * (1/step), by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * period)/2))
/
((gamma + lambda + cappa) * (exp(gamma * period) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * period) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * period) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = 1, lambda = .12, sigma = 84, theta = .7)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = 1, lambda = .12, sigma = 84, theta = .7)
plot(bp)
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t <<- c(seq(from = step, to = T * (1/step), by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * t)/2))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * t) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = 1, lambda = .12, sigma = 84, theta = .7)
plot(bp)
bp
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t = c(seq(from = step, to = T * (1/step), by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * t)/2))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * t) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
return(t)
}
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = 1, lambda = .12, sigma = 84, theta = .7)
plot(bp)
bp
bp
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t = c(seq(from = step, to = T * (1/step), by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * t)/2))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * t) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
return(t * (1/step))
}
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = 1, lambda = .12, sigma = 84, theta = .7)
plot(bp)
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t = c(seq(from = step, to = T * (1/step), by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * t)/2))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * t) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
return(T * (1/step))
}
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = 1, lambda = .12, sigma = 84, theta = .7)
plot(bp)
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t = c(seq(from = step, to = T, by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * t)/2))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * t) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = 1, lambda = .12, sigma = 84, theta = .7)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = 1, lambda = .12, sigma = .08, theta = .7)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = .08, lambda = .08, sigma = .08, theta = 6)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = .8, lambda = .025, sigma = .08, theta = 6)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.167, T = 40, step = 1/12, cappa = .8, lambda = .025, sigma = .08, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .8, lambda = .025, sigma = .08, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = .08, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = .8, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = .005, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = .05, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = .5, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = 1, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = 3, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = 1, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = .5, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = .25, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.16, T = 40, step = 1/12, cappa = 1, lambda = .025, sigma = .25, theta = 6)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .80, lambda = .003, sigma = .25, theta = .06)
plot(bp)
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t = c(seq(from = step, to = T, by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * (T-t)/2))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * t) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t = c(seq(from = step, to = T, by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * t/2))
/
((gamma + lambda + cappa) * (exp(gamma * t - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * t) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * t - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t = c(seq(from = step, to = T, by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * t)/2))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * t) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * t) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t = c(seq(from = step, to = T, by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * (T-t))/2))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * t) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .80, lambda = .003, sigma = .25, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .80, lambda = .003, sigma = .005, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .80, lambda = .03, sigma = .005, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .80, lambda = .03, sigma = .05, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .80, lambda = .03, sigma = 1, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = .0-3, sigma = 1, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = .0-3, sigma = 1, theta = .01)
plot(bp
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = .0-3, sigma = 1, theta = .01)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = .003, sigma = 1, theta = .01)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.00, sigma = 1, theta = .01)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.00, sigma = .01, theta = .01)
plot(bp)
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
t = c(seq(from = step, to = T, by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * (T-t))/2))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * (T-t)) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.00, sigma = .01, theta = .01)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = , theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = 1, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .12, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = 3, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .08, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .8, theta = .06)
plot(bp)
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
T = c(seq(from = step, to = T, by = step))
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * (T-t))/2))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * (T-t)) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .8, theta = .06)
plot(bp)
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
T = c(seq(from = step, to = T, by = step))
t = step
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * (T-t))/2))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * (T-t)) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .8, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .12, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .08, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .0025, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .025, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .25, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = 1, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = 1.5, theta = .06)
plot(bp)
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .5, theta = .06)
plot(bp)
#The function to Price of a bond under CIR Model
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
#T is the vector of maturities of the yield curve each cash flow is treated as a zero coupon bond
T = c(seq(from = step, to = T, by = step))
#t is the start period this is the first step of the simulation as well as the step size
#for example from t = 0 to the next period is 0 + step
t = step
#The below are the functions to determine the closed form solution to the CIR Model
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * (T-t))/2))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * (T-t)) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .90, lambda = 0.03, sigma = .5, theta = .06)
plot(bp)
library("BondLab", lib.loc="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
CIRBondPrice <- function(shortrate = vector(), T = numeric(), step = numeric(), cappa = numeric(),
lambda = numeric(), sigma = numeric(), theta = numeric()){
#The closed form function to the price of a bond under CIR Model
#T is the maturity is the zero coupon bond. To price a coupon paying bond this is the maturity of the bond
#step the time between each payment of a coupon paying bond
#cappa is the rate of mean reversion
#lambda is the market risk premium (lambda must be negative)
#sigma is interest rate variance - specificlly sigma^2
#theta is the mean interest rate level
#T is the vector of maturities of the yield curve each cash flow is treated as a zero coupon bond
T = c(seq(from = step, to = T, by = step))
#t is the start period this is the first step of the simulation as well as the step size
#for example from t = 0 to the next period is 0 + step
t = step
#The below are the functions to determine the closed form solution to the CIR Model
gamma = ((cappa + lambda)^2 + 2 * sigma) ^(1/2)
A.CIR = ((2 * gamma * exp(((cappa + lambda + gamma) * (T-t))/2))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma))) ^ ((2 * cappa * theta)/(sigma^2))
B.CIR = ((2 * (exp(gamma * (T-t)) - 1))
/
((gamma + lambda + cappa) * (exp(gamma * (T-t)) - 1) + (2 * gamma)))
Price = A.CIR * exp((B.CIR * -1) * shortrate)
}
CIR.Sim <- function(shortrate = numeric(), cappa = numeric(), theta = numeric(),
T = numeric(), step = numeric(), sigma = numeric(), N = numeric()){
#cappa is the rate of mean reversion
#theta is the long term value of the short rate
#T is the horizon
#step is the time between each payment of coupon paying bond
#N is the number of simulations
dt <- step
nrow <-  T/dt
deltarate <- function(cappa = numeric(), theta = numeric(), dt = numeric(), sigma = numeric()){
(cappa * (theta - simulation[i-1,j]) * dt) + sigma * sqrt(simulation[i-1,j]) * rnorm(1,0,1)}
#Matrix to hold the short rate paths
simulation = array(data = 0, c((nrow + 1), N))
#Populate the first element of each path with the short rate
simulation[1,] = shortrate
for(j in 1:N){
for(i in 2:(nrow + 1)){
simulation[i,j] <- simulation[i-1, j] + deltarate(cappa = cappa, theta = theta, dt = dt, sigma = sigma)
}
}
return(simulation)
}
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 15)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:15], type = "l")
bp <- CIRBondPrice(shortrate = 0.0016, T = 40, step = 1/12, cappa = .10, lambda = 0.03, sigma = .5, theta = .06)
plot(bp, type = "l")
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:15], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:15], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:15], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:15], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:15], type = "l")
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:15], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
View(simulation)
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma = 0.015, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
simulation <- CIR.Sim(shortrate = 0.0016, cappa = .10, theta = .06, T = 40, step = 1/12, sigma =0, N = 10)
Time <-seq(0, 40, 1/12)
matplot(Time, simulation[,1:10], type = "l")
View(simulation)
