}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
print(((Month - EndMonth) * (DownRamp / DownRampMonths)))
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month <= PeakMonth + PlateauEnd, PeakCDR + (Month - PeakMonth) * (DownRamp/DownRampMonths),
ifelse(Month >= PlateauEnd & Month <= EndMonth, PeakCDR ,
1)))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth , PeakCDR + (Month - PeakMonth) * (DownRamp/DownRampMonths),
ifelse(Month >= PlateauEnd & Month <= EndMonth, PeakCDR ,
1)))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth ,EndCDR,
ifelse(Month >= PlateauEnd & Month <= EndMonth, PeakCDR ,
1)))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month < PlateauEnd ,EndCDR,
ifelse(Month >= PlateauEnd & Month <= EndMonth, PeakCDR ,
1)))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth & Month <= PlateauEnd ,EndCDR,
ifelse(Month >= PlateauEnd & Month <= EndMonth, PeakCDR ,
1)))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth & Month <= PlateauEnd ,EndCDR, 0))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth && Month <= PlateauEnd ,EndCDR, 0))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth||Month <= PlateauEnd ,EndCDR, 0))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth||Month <= PlateauEnd ,PeakCDR, 0))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth && Month <= PlateauEnd ,PeakCDR, 0))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth & Month <= PlateauEnd ,PeakCDR, 0))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 12, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 24, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth & Month <= PlateauEnd ,PeakCDR,
ifelse(Month > PlateauEnd & Month <= EndMonth, 2,0)))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 24, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth & Month <= PlateauEnd ,PeakCDR,
ifelse(Month > PlateauEnd & Month <= EndMonth, PeakCDR + (Month - PlateauEnd) * (DownRamp/DownRampMonths),0)))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 24, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
CDR <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth & Month <= PlateauEnd ,PeakCDR,
ifelse(Month > PlateauEnd & Month <= EndMonth, PeakCDR + (Month - PlateauEnd) * (DownRamp/DownRampMonths),EndCDR)))
}
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 24, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 48, EndCDR = 1, EndMonth = 120, Month = c(seq(1,360, 1))), type = "l")
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 48, EndCDR = 1, EndMonth = 180, Month = c(seq(1,360, 1))), type = "l")
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 24, PlateauMonths = 48, EndCDR = 1, EndMonth = 240, Month = c(seq(1,360, 1))), type = "l")
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 48, EndCDR = 1, EndMonth = 240, Month = c(seq(1,360, 1))), type = "l")
plot(CDR(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 72, EndCDR = 1, EndMonth = 240, Month = c(seq(1,360, 1))), type = "l")
View(ModelData)
CDR.Model <- function(BeginCDR,
PeakCDR,
PeakMonth,
PlateauMonths,
EndCDR,
EndMonth,
Month) {
UpRamp = PeakCDR - BeginCDR
DownRamp = EndCDR - PeakCDR
DownRampMonths = EndMonth - (PeakMonth + PlateauMonths)
PlateauEnd = PeakMonth + PlateauMonths
ifelse(Month <= PeakMonth, 0 + ((Month-1) * (UpRamp / (PeakMonth - 1))),
ifelse(Month > PeakMonth & Month <= PlateauEnd ,PeakCDR,
ifelse(Month > PlateauEnd & Month <= EndMonth, PeakCDR + (Month - PlateauEnd) * (DownRamp/DownRampMonths),EndCDR)))
}
CDR <- data.frame(FH30.Default$time, FH30.Default$n.event/FH30.Default$n.risk)
colnames(CDR) <- c("LoanAge", "MDR")
View(CDR)
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 72, EndCDR = 1, EndMonth = 240, Month = c(seq(1,149, 1)))
test <- cbind(CDR, Model)
View(test)
options(contrasts = c("contr.treatment", "contr.treatment"))
ModelData <- read.csv("~/FHLLD/ModelData.csv", sep = ",", stringsAsFactor = FALSE)
ModelData$UpdatedLTV <- as.numeric(as.integer(as.numeric(ModelData$UpdatedLTV)))
# Survivorship Counting Process
FH30.Default <- (survfit(Surv(LoanAge, Event == 2)~1, data = ModelData))
survdata <- data.frame(FH30.Default$time, FH30.Default$surv)
colnames(survdata) <- c("LoanAge", "surv")
CDR <- data.frame(FH30.Default$time, FH30.Default$n.event/FH30.Default$n.risk)
colnames(CDR) <- c("LoanAge", "MDR")
View(CDR)
# Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 36, EndCDR = 1, EndMonth = 120, Month = c(seq(1,149, 1)))/100
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 72, EndCDR = 1, EndMonth = 240, Month = c(seq(1,149, 1)))
ModelData <- cbond(CDR, Model)
CDRModel <- cbind(CDR, Model)
View(CDRModel)
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 36, EndCDR = 1, EndMonth = 120, Month = c(seq(1,149, 1)))/100
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 36, EndCDR = 1, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- cbind(CDR, Model)
CDRModel <- cbind(CDR, Model)
View(CDRModel)
rm(CDR)
CDRModel <- data.frame(cbind(CDR, Model))
CDR <- data.frame(FH30.Default$time, FH30.Default$n.event/FH30.Default$n.risk)
colnames(CDR) <- c("LoanAge", "MDR")
CDRModel <- data.frame(cbind(CDR, Model))
CDRModel <- data.frame(cbind(CDR, Model))
colnames(CDRModel) <- c(LoanAge, CDR, Model)
View(CDRModel)
View(CDRModel)
CDRModel <- melt(CDRModel, id = LoanAge)
View(CDRModel)
CDRModel <- melt(CDRModel, id = "LoanAge")
View(CDRModel)
CDR <- data.frame(FH30.Default$time, FH30.Default$n.event/FH30.Default$n.risk)
CDR[,2] <- 1-(1-CDR[,2])^12
colnames(CDR) <- c("LoanAge", "MDR")
# Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 36, EndCDR = 1, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- data.frame(cbind(CDR, Model))
colnames(CDRModel) <- c(LoanAge, CDR, Model)
CDRModel <- melt(CDRModel, id = "LoanAge")
View(CDR)
Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 36, EndCDR = 1, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- data.frame(cbind(CDR, Model))
colnames(CDRModel) <- c(LoanAge, CDR, Model)
CDRModel <- data.frame(cbind(CDR, Model))
View(CDRModel)
colnames(CDRModel) <- c(LoanAge, CDR, Model)
Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 36, EndCDR = 1, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- data.frame(cbind(CDR, Model))
View(CDRModel)
colnames(CDRModel) <- c(LoanAge, CDR, Model)
CDRModel <- melt(CDRModel, id = "LoanAge")
View(CDRModel)
View(CDRModel)
#plot 20.1
ggplot(CDRModel, aes(x=LoanAge, y = Value)) +
geom_step() +
theme_minimal()
View(CDRModel)
#plot 20.1
ggplot(CDRModel, aes(x=LoanAge, y = value)) +
geom_step() +
theme_minimal()
View(CDRModel)
#plot 20.1
ggplot(CDRModel, aes(x=LoanAge, y = value)) +
geom_step() +
theme_minimal()
View(CDRModel)
#plot 20.1
ggplot(CDRModel, aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal()
# Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 3, PeakMonth = 36, PlateauMonths = 36, EndCDR = 1.5, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- data.frame(cbind(CDR, Model))
colnames(CDRModel) <- c(LoanAge, CDR, Model)
CDRModel <- melt(CDRModel, id = "LoanAge")
#plot 20.1
ggplot(CDRModel, aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal()
Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 2.5, PeakMonth = 36, PlateauMonths = 36, EndCDR = 1.5, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- data.frame(cbind(CDR, Model))
colnames(CDRModel) <- c(LoanAge, CDR, Model)
CDRModel <- melt(CDRModel, id = "LoanAge")
#plot 20.1
ggplot(CDRModel, aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal()
#plot 20.1
ggplot(CDRModel, aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age")
#plot 20.1
ggplot(CDRModel, aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 120), aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 145), aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 140), aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
# Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 2.5, PeakMonth = 42, PlateauMonths = 36, EndCDR = 1.5, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- data.frame(cbind(CDR, Model))
colnames(CDRModel) <- c(LoanAge, CDR, Model)
CDRModel <- melt(CDRModel, id = "LoanAge")
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 140), aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
# Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 2.5, PeakMonth = 42, PlateauMonths = 24, EndCDR = 1.5, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- data.frame(cbind(CDR, Model))
colnames(CDRModel) <- c(LoanAge, CDR, Model)
CDRModel <- melt(CDRModel, id = "LoanAge")
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 140), aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 2.5, PeakMonth = 42, PlateauMonths = 30, EndCDR = 1.5, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- data.frame(cbind(CDR, Model))
colnames(CDRModel) <- c(LoanAge, CDR, Model)
CDRModel <- melt(CDRModel, id = "LoanAge")
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 140), aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
Fit CDR Model to Data
Model <-CDR.Model(BeginCDR = 0, PeakCDR = 2.75, PeakMonth = 42, PlateauMonths = 30, EndCDR = 1.5, EndMonth = 120, Month = c(seq(1,149, 1)))/100
CDRModel <- data.frame(cbind(CDR, Model))
colnames(CDRModel) <- c(LoanAge, CDR, Model)
CDRModel <- melt(CDRModel, id = "LoanAge")
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 140), aes(x=LoanAge, y = value, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 140), aes(x=LoanAge, y = value * 100, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 136), aes(x=LoanAge, y = value * 100, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 145), aes(x=LoanAge, y = value * 100, linetype = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 145), aes(x=LoanAge, y = value * 100, group = variable)) +
geom_step() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 145), aes(x=LoanAge, y = value * 100, group = variable)) +
geom_line() +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 145), aes(x=LoanAge, y = value * 100, group = variable)) +
geom_line(linetype = c('line', 'dashed')) +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
#plot 20.1
ggplot(subset(CDRModel, LoanAge < 145), aes(x=LoanAge, y = value * 100, group = variable)) +
geom_line(linetype = c("solid", "dashed")) +
theme_minimal() +
ylab("Constant Default Rate (CDR)")+
xlab("Loan Age") +
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20))
