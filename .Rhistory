xlab("Age") +
ylab("CPR") +
theme_minimal()+
theme_minimal()+
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20)) +
scale_colour_grey(name = "Legend", labels = c("150 PSA", "100 PSA", "50 PSA")) +
theme(legend.position=c(.15,.92), legend.background = element_rect(fill = "white", colour = "white")) +
theme(legend.key= element_rect(fill="white", colour= "white"))
flatten <-PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
price = 100, trade.date = "01-02-2013",
settlement.date = "01-05-2013",
PrepaymentAssumption = "MODEL",
scenario.set = "Flat50")
base <- PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
price = 100,
trade.date = "01-02-2013",
settlement.date = "01-05-2013",
PrepaymentAssumption = "MODEL",
scenario.set = "NC")
data46 <- as.data.frame(cbind(seq(1, 360, 1), flatten@Scenario[1][[1]]@TotalCashFlow, base@TotalCashFlow))
colnames(data46) <- c("Period", "Flatten", "Base")
data46 <- melt(data46, id = c("Period"))
ggplot(data46, aes(x = Period, y = value, colour = variable, linetype = variable))+
geom_line(aes(linetype = variable), size = 1) +
theme_minimal()+
scale_x_continuous(breaks = c(1, 36, 60, 84, 120, 180, 240, 360)) +
scale_y_continuous(breaks = c(0, 250, 500, 750, 1000)) +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow") +
scale_colour_manual(values = cbbPalette) +
scale_linetype_manual(values = c("solid", "dotdash")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20)) +
theme(panel.grid.major = element_line(size = .25, color = "grey"))+
theme(legend.position=c(.85,.90), legend.background = element_rect(fill = "white", colour = "white")) +
theme(legend.title=element_blank())
steepen <-PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000, price = 100,
trade.date = "01-02-2013",
settlement.date = "01-05-2013",
PrepaymentAssumption = "MODEL",
scenario.set = "Steep50")
base <- PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000, price = 100,
trade.date = "01-02-2013",
settlement.date = "01-05-2013",
PrepaymentAssumption = "MODEL",
scenario.set = "NC")
data43 <- as.data.frame(cbind(seq(1, 360, 1), steepen@Scenario[1][[1]]@TotalCashFlow, base@TotalCashFlow))
colnames(data43) <- c("Period", "Steepen", "Base Case")
data43 <- melt(data43, id = c("Period"))
ggplot(data43, aes(x = Period, y = value, colour = variable, linetype = variable))+
geom_line(size = 1.0) +
theme_minimal()+
scale_x_continuous(breaks = c(1, 36, 60, 84, 120, 180, 240, 360)) +
scale_y_continuous(breaks = c(0, 250, 500, 750, 1000)) +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow") +
scale_colour_manual(values = cbbPalette) +
scale_linetype_manual(values = c("solid", "dotdash")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20)) +
theme(panel.grid.major = element_line(size = .25, color = "grey"))+
theme(legend.position=c(.80,.90), legend.background = element_rect(fill = "white", colour = "white"))+
theme(legend.title=element_blank())
cbbPalette <- c("#E69F00",
"#56B4E9",
"#009E73",
"#F0E442",
"#0072B2",
"#D55E00",
"#CC79A7",
"#000000",
"#E69F00",
"#56B4E9",
"#009E73",
"#F0E442",
"#0072B2",
"#D55E00",
"#CC79A7",
"#000000"
)
ggplot(data43, aes(x = Period, y = value, colour = variable, linetype = variable))+
geom_line(size = 1.0) +
theme_minimal()+
scale_x_continuous(breaks = c(1, 36, 60, 84, 120, 180, 240, 360)) +
scale_y_continuous(breaks = c(0, 250, 500, 750, 1000)) +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow") +
scale_colour_manual(values = cbbPalette) +
scale_linetype_manual(values = c("solid", "dotdash")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20)) +
theme(panel.grid.major = element_line(size = .25, color = "grey"))+
theme(legend.position=c(.80,.90), legend.background = element_rect(fill = "white", colour = "white"))+
theme(legend.title=element_blank())
# 1-01-3013 and 1-05-2013 are not trading days they are used to hold the yield curve scenarios presented in chapter 4
flatten <-PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
price = 100, trade.date = "01-02-2013",
settlement.date = "01-05-2013",
PrepaymentAssumption = "MODEL",
scenario.set = "Flat50")
base <- PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
price = 100,
trade.date = "01-02-2013",
settlement.date = "01-05-2013",
PrepaymentAssumption = "MODEL",
scenario.set = "NC")
data46 <- as.data.frame(cbind(seq(1, 360, 1), flatten@Scenario[1][[1]]@TotalCashFlow, base@TotalCashFlow))
colnames(data46) <- c("Period", "Flatten", "Base")
data46 <- melt(data46, id = c("Period"))
ggplot(data46, aes(x = Period, y = value, colour = variable, linetype = variable))+
geom_line(aes(linetype = variable), size = 1) +
theme_minimal()+
scale_x_continuous(breaks = c(1, 36, 60, 84, 120, 180, 240, 360)) +
scale_y_continuous(breaks = c(0, 250, 500, 750, 1000)) +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow") +
scale_colour_manual(values = cbbPalette) +
scale_linetype_manual(values = c("solid", "dotdash")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20)) +
theme(panel.grid.major = element_line(size = .25, color = "grey"))+
theme(legend.position=c(.85,.90), legend.background = element_rect(fill = "white", colour = "white")) +
theme(legend.title=element_blank())
library(ggplot2)
library(termstrc)
library(reshape2)
library(grid)
cbbPalette <- c("#E69F00",
"#56B4E9",
"#009E73",
"#F0E442",
"#0072B2",
"#D55E00",
"#CC79A7",
"#000000",
"#E69F00",
"#56B4E9",
"#009E73",
"#F0E442",
"#0072B2",
"#D55E00",
"#CC79A7",
"#000000"
)
PSA.Data <- function(length, base, faster, slower){
require(reshape2)
require(ggplot2)
ramps <- array(data = NA, c(60,4), dimnames = list(seq(1:60), c("age", "faster", "base", "slower")))
ramps[,1] <- seq(from = 1, to = length, by = 1)
ramps[,2] <- PPC.Ramp(period = ramps[,1], season.period = 30, begin.cpr = .002, end.cpr = .06) * faster
ramps[,3] <- PPC.Ramp(period = ramps[,1], season.period = 30, begin.cpr = .002, end.cpr = .06) * base
ramps[,4] <- PPC.Ramp(period = ramps[,1], season.period = 30, begin.cpr = .002, end.cpr = .06) * slower
return(melt(as.data.frame(ramps), id = c("age")))
}
Exhibit <- PSA.Data(60, 1, 1.5, .5)
ggplot(Exhibit, aes(x= age, y = value * 100, colour = variable, linetype = variable)) +
geom_line()+
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow") +
scale_colour_manual(values = cbbPalette) +
xlab("Age") +
ylab("CPR") +
theme_minimal()+
theme_minimal()+
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20)) +
#scale_colour_grey(name = "Legend", labels = c("150 PSA", "100 PSA", "50 PSA")) +
theme(legend.position=c(.15,.92), legend.background = element_rect(fill = "white", colour = "white")) +
theme(legend.key= element_rect(fill="white", colour= "white"))
ggplot(Exhibit, aes(x= age, y = value * 100, colour = variable, linetype = variable)) +
geom_line(size = 1.5)+
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow") +
scale_colour_manual(values = cbbPalette) +
xlab("Age") +
ylab("CPR") +
theme_minimal()+
theme_minimal()+
theme(panel.grid.major = element_line(size = .25, color = "grey")) +
theme(axis.text = element_text(size = 15)) +
theme(axis.title = element_text(size = 20)) +
#scale_colour_grey(name = "Legend", labels = c("150 PSA", "100 PSA", "50 PSA")) +
theme(legend.position=c(.15,.92), legend.background = element_rect(fill = "white", colour = "white")) +
theme(legend.key= element_rect(fill="white", colour= "white"))
CashFlow = PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
trade.date = "01-11-2013",
settlement.date = "01-15-2013",
price = 100,
PrepaymentAssumption = "PPC",
scenario.set = "NC"
begin.cpr = .2,
end.cpr = 6,
seasoning.period = 30,
CPR = 6)
CashFlow = PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
trade.date = "01-11-2013",
settlement.date = "01-15-2013",
price = 100,
PrepaymentAssumption = "PPC",
scenario.set = "NC",
begin.cpr = .2,
end.cpr = 6,
seasoning.period = 30)
plotdata = as.data.frame(cbind(CashFlow@Period,
CashFlow@ScheduledPrin,
CashFlow@PrepaidPrin,
CashFlow@PassThroughInterest,
CashFlow@ServicingIncome,
CashFlow@PMIPremium,
CashFlow@GFeePremium))
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
plotdata = melt(plotdata, id = "Period")
plotdata = ddply(plotdata, "Period", transform, Percent = value/sum(value))
# Exhibit 7.2
ggplot(plotdata, aes(x= Period, y = Percent* 100, fill = variable)) +
geom_area() +
theme_minimal()+
scale_fill_brewer(palette = "Greys") +
scale_y_reverse() +
labs(fill = "") +
ylab("Pool Cash Flow Pct. (%) of Payment") +
xlab("Period") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.75,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
plotdata = melt(plotdata, id = "Period")
plotdata = ddply(plotdata, "Period", transform, Percent = value/sum(value))
library("plyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
plotdata = melt(plotdata, id = "Period")
plotdata = ddply(plotdata, "Period", transform, Percent = value/sum(value))
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
plotdata = melt(plotdata, id = "Period")
plotdata = ddply(plotdata, "Period", transform, Percent = value/sum(value))
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
plotdata = as.data.frame(cbind(CashFlow@Period,
CashFlow@ScheduledPrin,
CashFlow@PrepaidPrin,
CashFlow@PassThroughInterest,
CashFlow@ServicingIncome,
CashFlow@PMIPremium,
CashFlow@GFeePremium))
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
View(Exhibit)
View(plotdata)
View(plotdata)
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
plotdata = melt(plotdata, id = "Period")
View(plotdata)
plotdata = ddply(plotdata, "Period", transform, Percent = value/sum(value))
# Exhibit 7.2
ggplot(plotdata, aes(x= Period, y = Percent* 100, fill = variable)) +
geom_area() +
theme_minimal()+
scale_fill_brewer(palette = "Greys") +
scale_y_reverse() +
labs(fill = "") +
ylab("Pool Cash Flow Pct. (%) of Payment") +
xlab("Period") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.75,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
CashFlow = PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
trade.date = "01-11-2013",
settlement.date = "01-15-2013",
price = 100,
PrepaymentAssumption = "PPC",
scenario.set = "NC",
begin.cpr = .0,
end.cpr = 0,
seasoning.period = 30)
plotdata = as.data.frame(cbind(CashFlow@Period,
CashFlow@ScheduledPrin,
CashFlow@PrepaidPrin,
CashFlow@PassThroughInterest,
CashFlow@ServicingIncome,
CashFlow@PMIPremium,
CashFlow@GFeePremium))
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
plotdata = melt(plotdata, id = "Period")
plotdata = ddply(plotdata, "Period", transform, Percent = value/sum(value))
# Exhibit 7.2
ggplot(plotdata, aes(x= Period, y = Percent* 100, fill = variable)) +
geom_area() +
theme_minimal()+
scale_fill_brewer(palette = "Greys") +
scale_y_reverse() +
labs(fill = "") +
ylab("Pool Cash Flow Pct. (%) of Payment") +
xlab("Period") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.75,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
# Exhibit 7.2
ggplot(plotdata, aes(x= Period, y = Percent* 100, fill = variable)) +
geom_area() +
theme_minimal()+
scale_colour_manual(values = cbbPalette) +
scale_y_reverse() +
labs(fill = "") +
ylab("Pool Cash Flow Pct. (%) of Payment") +
xlab("Period") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.75,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
ggplot(plotdata, aes(x= Period, y = Percent* 100, fill = variable)) +
geom_area() +
theme_minimal()+
scale_colour_manual(values = cbbPalette) +
#scale_y_reverse() +
labs(fill = "") +
ylab("Pool Cash Flow Pct. (%) of Payment") +
xlab("Period") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.75,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
# Exhibit 7.2
ggplot(plotdata, aes(x= Period, y = Percent* 100, colour = variable, fill = variable)) +
geom_area() +
theme_minimal()+
scale_colour_manual(values = cbbPalette) +
scale_y_reverse() +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow") +
#ylab("Pool Cash Flow Pct. (%) of Payment") +
#xlab("Period") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.75,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
# Exhibit 7.2
ggplot(plotdata, aes(x= Period, y = Percent* 100, colour = variable, fill = variable)) +
geom_area() +
theme_minimal()+
scale_colour_manual(values = cbbPalette) +
scale_y_reverse() +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow (%) Pct of Pmt") +
#ylab("Pool Cash Flow Pct. (%) of Payment") +
#xlab("Period") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.75,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
# Exhibit 7.2
ggplot(plotdata, aes(x= Period, y = Percent* 100, fill = variable, fill = variable)) +
geom_area() +
theme_minimal()+
scale_colour_manual(values = cbbPalette) +
scale_y_reverse() +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow (%) Pct of Pmt") +
#ylab("Pool Cash Flow Pct. (%) of Payment") +
#xlab("Period") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.75,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
# Exhibit 7.2
ggplot(plotdata, aes(x= Period, y = Percent* 100, fill = variable, fill = variable)) +
geom_area() +
theme_minimal()+
scale_fill_manual(values = cbbPalette) +
scale_y_reverse() +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Cash Flow (%) Pct of Pmt") +
#ylab("Pool Cash Flow Pct. (%) of Payment") +
#xlab("Period") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.75,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
#Exhibit 7.3
ggplot(plotdata, aes(x= Period, y = value, fill = variable)) +
geom_area() +
theme_minimal()+
scale_fill_manual(values = cbbPalette) +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Pool Cash Flow per $100,000 Orig. Bal.") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.82,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
CashFlow = PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
trade.date = "01-11-2013",
settlement.date = "01-15-2013",
price = 100,
PrepaymentAssumption = "PPC",
scenario.set = "NC",
begin.cpr = .02,
end.cpr = 06,
seasoning.period = 30)
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
plotdata = melt(plotdata, id = "Period")
#plotdata = ddply(plotdata, "Period", transform, Percent = value/sum(value))
#Exhibit 7.3
ggplot(plotdata, aes(x= Period, y = value, fill = variable)) +
geom_area() +
theme_minimal()+
scale_fill_manual(values = cbbPalette) +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Pool Cash Flow per $100,000 Orig. Bal.") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.82,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
plotdata = melt(plotdata, id = "Period")
plotdata = ddply(plotdata, "Period", transform, Percent = value/sum(value))
#Exhibit 7.3
ggplot(plotdata, aes(x= Period, y = value, fill = variable)) +
geom_area() +
theme_minimal()+
scale_fill_manual(values = cbbPalette) +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Pool Cash Flow per $100,000 Orig. Bal.") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.82,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
CashFlow = PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
trade.date = "01-11-2013",
settlement.date = "01-15-2013",
price = 100,
PrepaymentAssumption = "PPC",
scenario.set = "NC",
begin.cpr = .02,
end.cpr = 06,
seasoning.period = 30)
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
CashFlow = PassThroughAnalytics(bond.id = "bondlabMBS4",
original.bal = 100000,
trade.date = "01-11-2013",
settlement.date = "01-15-2013",
price = 100,
PrepaymentAssumption = "PPC",
scenario.set = "NC",
begin.cpr = .02,
end.cpr = 06,
seasoning.period = 30)
plotdata = as.data.frame(cbind(CashFlow@Period,
CashFlow@ScheduledPrin,
CashFlow@PrepaidPrin,
CashFlow@PassThroughInterest,
CashFlow@ServicingIncome,
CashFlow@PMIPremium,
CashFlow@GFeePremium))
colnames(plotdata) <- c("Period", "Scheduled Principal",
"Prepaid Principal", "Pass-Through Interest", "Servicing", "PMI", "GFee")
plotdata = melt(plotdata, id = "Period")
ggplot(plotdata, aes(x= Period, y = value, fill = variable)) +
geom_area() +
theme_minimal()+
scale_fill_manual(values = cbbPalette) +
labs(colour = "Legend", linetype = "Legend", x = "PoolAge (Mos.)", y = "Pool Cash Flow per $100,000 Orig. Bal.") +
theme(axis.title.y=element_text(angle = 90, size = 20)) +
theme(axis.text.y = element_text(angle = 90, size = 15)) +
theme(axis.title.x=element_text(angle = 0, size = 20)) +
theme(axis.text.x = element_text(angle = 0, size = 15)) +
theme(legend.position = c(.82,.73))+
theme(axis.title.y = element_text(vjust = .3)) +
theme(legend.background = element_rect(fill = "white"))
